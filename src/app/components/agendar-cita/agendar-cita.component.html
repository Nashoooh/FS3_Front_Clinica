<div class="container mt-4">
  <h2>Agendar Nueva Cita</h2>
  <p>Selecciona el tipo de análisis, el laboratorio y la fecha para tu próxima cita.</p>

  <form [formGroup]="citaForm" (ngSubmit)="onSubmit()" class="card p-4">
    <div class="row">
      <!-- Columna para Análisis y Laboratorio -->
      <div class="col-md-6">
        <div class="form-group mb-3">
          <label for="analisis">Tipo de Análisis</label>
          <select id="analisis" formControlName="analisisId" class="form-control">
            <option value="" disabled>Selecciona un análisis...</option>
            <option *ngFor="let item of analisis$ | async" [value]="item.id">{{ item.nombre }}</option>
          </select>
        </div>

        <div class="form-group mb-3">
          <label for="laboratorio">Laboratorio</label>
          <select id="laboratorio" formControlName="laboratorioId" class="form-control">
            <option value="" disabled>Selecciona un laboratorio...</option>
            <option *ngFor="let lab of laboratorios$ | async" [value]="lab.id">{{ lab.nombre }}</option>
          </select>
        </div>
      </div>

      <!-- Columna para Fecha y Hora -->
      <div class="col-md-6">
        <div class="form-group mb-3">
          <label for="fecha">Fecha</label>
          <input type="date" id="fecha" formControlName="fecha" class="form-control">
        </div>

        <div class="form-group mb-3">
          <label for="hora">Hora</label>
          <input type="time" id="hora" formControlName="hora" class="form-control">
        </div>
      </div>
    </div>

    <!-- Mensajes y Botón -->
    <div *ngIf="successMessage" class="alert alert-success mt-3">{{ successMessage }}</div>
    <div *ngIf="errorMessage" class="alert alert-danger mt-3">{{ errorMessage }}</div>

    <button type="submit" class="btn btn-primary mt-3" [disabled]="loading || citaForm.invalid">
      <span *ngIf="loading" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
      {{ loading ? 'Agendando...' : 'Agendar Cita' }}
    </button>
  </form>
</div>
